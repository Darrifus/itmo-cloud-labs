# Лабораторная работа № 3 со звездочкой

## Задание
* Сделать красиво работу с секретами
* Аргументировать "красивость"

## Выполнили человеки
* Усольцева Дарья
* Забродский Александр
* Азатжонова Мехринисо

## Начинаем делать лабу
Мы, когда надо сделать так, чтобы ci/cd паплайн ходил туда, не знаю куда, чтобы брать секрет:

<img src="https://github.com/user-attachments/assets/0ad0e751-d15f-4097-b3a7-5d1dd24dc406" width="350" />
<img src="https://github.com/user-attachments/assets/9341b470-45e8-4dac-be45-d98f248d40cb" width="260" />



## Выполнение лабы
Для выполнения лабораторной работы были использованы CI/CD файл с "хорошими практиками" и облачная платформа для управления секретами Doppler. 

В Doppler был создан проект, который синхронизируем с аккаунтом Github:

![Снимок экрана 2024-12-03 235224](https://github.com/user-attachments/assets/1e3dcacf-dab8-47bc-866a-ede252c9426f)

Далее в этом проекте задаем наши секреты - в данном случае `SECRET_DEPLOY_PATH`(путь для деплояя):

![Снимок экрана 2024-12-04 000949](https://github.com/user-attachments/assets/9401ae9c-eeae-4355-9918-cb488ee48273)

Был создан `DOPPLER_TOKEN`, который предоставляет нашему пайплайну доступ к Doppler для работы с секретами:

![image](https://github.com/user-attachments/assets/f6f04363-923e-415f-99ab-6a195d0a08e8)

После этого переходим в наш репозиторий в Github и в настройках добавляем сгенерированный ранее токен как секрет:

![image](https://github.com/user-attachments/assets/634f64b3-bddb-43c9-b356-c2254aff19ca)

Далее был дополнен код CI/CD файла:

1. был установлен CLI Doppler и выполнена авторизация с использованием токена
2. была реализована загрузка секретов из Doppler в формате env, чтобы их можно было использовать в дальнейших шагах пайплайна
3. деплой проекта в папку, путь к которой задавался через секрет

Пайплайн был запущен в Github Actions:

![Снимок экрана 2024-12-04 014441](https://github.com/user-attachments/assets/c6c0c655-20a4-42e0-8726-62eb01a9a04e)


Скрины измененного пайплайна:

![Снимок экрана 2024-12-04 014744](https://github.com/user-attachments/assets/31027c30-6951-48fe-b9c4-bfb4cd63c68f)

![Снимок экрана 2024-12-04 014728](https://github.com/user-attachments/assets/65aa677a-abb0-41e4-bd6a-a733c010074f)


### Почему наш способ(Doppler) "красивый"?

- легкость подключения к GitHub, пайплайнам и GitHub Actions
- автоматическое шифрование и доступ через токен, что исключает риски утечек
- возможность хранить все секреты в одном месте, где их легко изменять/обновлять
- возможность управлять сроком действия секретов без изменений в коде


### Почему хранение секретов в CI/CD переменных репозитория не является хорошей практикой?

- риск утечек из-за открытости доступа всем, кто имеет доступ к репозиторию
- трудности с их обновлением при необходимости изменений
- сложность работы с секретами в переменных при возрастании масштаба проекта

  
### Заключение
1. Работу с секретами красиво сделали
2. Пайплайн запустили и показали, что все работает
3. "Красивость" нашего способа показали
4. "Плохость" хранения секретов в переменных объяснили

А значит лаба выполнена!


Мы, преисполнившись в хранении секретов:

<img src="https://github.com/user-attachments/assets/a8cdc12f-4d3d-4415-a428-2f5527a83ded" width="350" />

## Это мы гордимся проделанной работой и отдыхаем

<img src="https://github.com/user-attachments/assets/94bcd8c4-36ea-4c18-b247-df7315dfcb07" width="350" />




