# Лабораторная №2 со звёздочкой

## Задание
* Написать “плохой” Docker compose файл, в котором есть не менее трех “bad practices” по их написанию.
* Написать “хороший” Docker compose файл, в котором эти плохие практики исправлены.

## Выполнили человеки
* Усольцева Дарья
* Забродский Александр
* Азатжонова Мехринисо

## Установка Docker compose
Первым делом устанавливаем Docker compose на операционную систему. В нашем случае это Linux, а именно Ubuntu:24.04, запущенная через VirtualBox. Для того чтобы установить Docker compose, нужно открыть терминал и поочерёдно ввести команды:
* mkdir -p ~/.docker/cli-plugins/
* curl -SL https://github.com/docker/compose/releases/download/v2.27.0/docker-compose-linux-x86_64 -o ~/.docker/cli-plugins/docker-compose
* chmod +x ~/.docker/cli-plugins/docker-compose

Готово, Docker compose установлен. Осталось только проверить это. 

![net](https://github.com/Darrifus/itmo-cloud-labs/blob/main/DevOps%20%D0%9B%D0%B0%D0%B1%D0%B0%202%20%D1%81%D0%BE%20%D0%B7%D0%B2%D1%91%D0%B7%D0%B4%D0%BE%D1%87%D0%BA%D0%BE%D0%B9/Downloading-docker-cpmpose.png)

Видим, что в консоли выводится версия установленного Docker compose. Значит, всё установленно и работает.

## Написание Docker compose файла

Docker compose - это инструмент для работы с контейнерами Docker. С его помощью можно эффективно и удобно управлять средами, в которых запущено более одного контейнера. Средами, в которых запущен только 1 контейнер, естесственно тоже можно управлять с помощью упомянтуого инструмента. Использование Docker compose позволяет обеспечивать изоляцию окружений, запускать, пересобирать и останавливать контейнеры одновременно, следить за их статусом и получить множество других удобных и полезных преимуществ.

Для работы с Docker compose необходимо создать текстовый файл docker-compose.yml, в котором будет осуществляться вся последующая работа с сервисом. Для поднятия всех сервисов, указанных в этом файле, нужно, находясь в одной дериктории с написанным файлом, написать в консоль команду:

* sudo docker compose up

Далее при выполнении лабораторной работы так же использовались команды:

1. sudo docker system prune

Данная команда удаляет из системы всю информацию про докеры. Это позволяет запускать новые докеры, не опасаясь что на устройстве закончится память. 

2. sudo docker stop <название первого контейнера> <название второго контейнера>

Вторая же команда позволяет остонавливать контейнеры. После их остановки можно поменять файл docker-compose.yml и другие файлы, которые файлы, с которыми взаимодействуют контейнеры, и после этого запустить их снова. Это так же будет экономить время и место на компьютере, ведь контейнерам не придётся запускаться занова с нуля. Если нужно сделать незначительное изменение в коде, то при запуске на контейнер уже не будет скачиваться операционная система и ранее установленные утилиты. Важно не забывать, что к указанным в docker-compose.yml названиям сервисов в началае надо добавлять "<путь до директории, в которой лежит наш файл>-", а в конце - "-1".

### Плохой Docker compose файл

Так как в последнем задании нам предстоит проверять связь между докерами, мы решили сделать два сервиса, которые выполняют простой скрипт на языке bash, который сначала выводит в консоль сообщение о том, что контейнер работает а также его номер, а потом с помощью утилиты ping проверяет соединение с интернетом, выполняя команду:

* ping -c 2 8.8.8.8

В данном случае опция -c 2 обозначает, что соединение с 8.8.8.8 будет происходить не до бесконечности, а только 2 раза.

Далее опишем плохие практики, которые мы использовали при написании плохого Docker compose файла.

* image: ubuntu:latest

1. Первой плохой практикой при написании нашего Docker compose файла является использование тега :latest. Использование этого тега для загрузки последней версии является антипаттерном при написании как докерфайлов, так и Docker compose файлов. Использование последней версии образа дестабилизирует систему. Через время последняя версия образа скорее всего изменится, собираемый докер тогда будет устанавливать другой образ, и выполняемые команды могут начать исполняться совсем по-другому.

- container_name: cont1

2. Второй плохой практикой при написании нашего Docker compose файла является жёстко заданное имя контейнера. Это связано с несколькими причинами. Во-первых жёстко заданное имя лишает систему гибкости при использовании. При изменении окружений привязанный к конкретной конфигурации контейнер может быть неудобным. Во-вторых становится сложнее следить за всей системой. Файл становится менее читабельным.

* ./scripts:/scripts
  
3. Третьей плохой практикой является хранение данных на локальной системе без правильно организованных прав доступа. Это создаст угрозу уязвимости для хоста. Так же права доступа на хосте могут не совпасть с правами доступа внутри контейнера. Это может вызвать конфликт. В конце концов, контейнер становится менее переносимым с одной системы на другую, если он использует файлы на хосте.

### Хороший Docker compose файл

А тут пишу какой я молодец исправил всё что не надо было делать и как надо делать

## Настройка сервисов для достижения изоляции работающих контейнеров друг от друга

Тут разбираюсь что нужно сделать говорю как я это делаю и зачем я это делаю а потом показываю что я это сделал

## Результаты

А тут я говорю какой я молодец что сделал зачем и в чём смысл

Итак, все задания из ТЗ сделаны, а значит лаба выполнена!

## Это мы отдыхаем

Сюда котиков вставить потом
